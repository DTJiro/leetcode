package leetcode.editor.cn;

#Flightsè¡¨ 
#
# 
#+-------------+------+
#| åˆ—å         | ç±»åž‹ |
#+-------------+------+
#| flight_id   | int  |
#| capacity    | int  |
#+-------------+------+
#flight_id æ˜¯è¯¥è¡¨ä¸­å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚ 
#è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«èˆªç­IDå’Œå®ƒçš„åº§ä½å®¹é‡ã€‚
# 
#
# Passengersè¡¨ 
#
# 
#+--------------+------+
#| Column Name  | Type |
#+--------------+------+
#| passenger_id | int  |
#| flight_id    | int  |
#+--------------+------+
#passenger_id æ˜¯è¯¥è¡¨ä¸­å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¹˜å®¢IDå’Œèˆªç­IDã€‚
# 
#
# ä¹˜å®¢æå‰é¢„è®¢èˆªç­æœºç¥¨ã€‚å¦‚æžœä¹˜å®¢é¢„è®¢äº†æŸä¸ªèˆªç­çš„æœºç¥¨ï¼Œå¹¶ä¸”è¯¥èˆªç­è¿˜æœ‰ç©ºåº§ä½ï¼Œä¹˜å®¢çš„æœºç¥¨å°†ä¼šå¾—åˆ° ç¡®è®¤ ã€‚ç„¶è€Œï¼Œå¦‚æžœèˆªç­å·²ç»æ»¡å‘˜ï¼Œä¹˜å®¢å°†ä¼šè¿›å…¥ ç­‰å¾…åå• ã€‚ 
#
# ç¼–å†™è§£å†³æ–¹æ¡ˆï¼ŒæŠ¥å‘Šæ¯ä¸ªèˆªç­å·²æˆåŠŸé¢„è®¢ï¼ˆèŽ·å¾—åº§ä½ï¼‰çš„ä¹˜å®¢æ•°ä»¥åŠå¤„äºŽç­‰å¾…åå•ä¸Šçš„ä¹˜å®¢æ•°ã€‚ 
#
# æŒ‰ç…§ flight_id å‡åºæŽ’åº è¿”å›žç»“æžœè¡¨ã€‚ 
#
# ç»“æžœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚ 
#
# 
#
# ç¤ºä¾‹ 1ï¼š 
#
# 
#è¾“å…¥ï¼š
#Flights table:
#+-----------+----------+
#| flight_id | capacity |
#+-----------+----------+
#| 1         | 2        |
#| 2         | 2        |
#| 3         | 1        |
#+-----------+----------+
#Passengers table:
#+--------------+-----------+
#| passenger_id | flight_id |
#+--------------+-----------+
#| 101          | 1         |
#| 102          | 1         |
#| 103          | 1         |
#| 104          | 2         |
#| 105          | 2         |
#| 106          | 3         |
#| 107          | 3         |
#+--------------+-----------+
#è¾“å‡ºï¼š
#+-----------+------------+--------------+
#| flight_id | booked_cnt | waitlist_cnt |
#+-----------+------------+--------------+
#| 1         | 2          | 1            |
#| 2         | 2          | 0            |
#| 3         | 1          | 1            |
#+-----------+------------+--------------+
#è§£é‡Šï¼š
#- èˆªç­ 1 çš„åº§ä½å®¹é‡ä¸º 2ã€‚ç”±äºŽæœ‰ 3 åä¹˜å®¢é¢„è®¢äº†æœºç¥¨ï¼Œåªæœ‰ 2 åä¹˜å®¢å¯ä»¥èŽ·å¾—åº§ä½ã€‚å› æ­¤ï¼Œæœ‰ 2 åä¹˜å®¢æˆåŠŸé¢„è®¢ï¼Œå¹¶ä¸”æœ‰ 1 åä¹˜å®¢åœ¨ç­‰å¾…åå•ä¸Šã€‚
#- èˆªç­ 2 çš„åº§ä½å®¹é‡ä¸º 2ã€‚ç”±äºŽæœ‰ 2 åä¹˜å®¢é¢„è®¢äº†æœºç¥¨ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥èŽ·å¾—åº§ä½ã€‚ç»“æžœæ˜¯ï¼Œæœ‰ 2 åä¹˜å®¢æˆåŠŸé¢„è®¢äº†åº§ä½ï¼Œä¸”æ²¡æœ‰ä¹˜å®¢åœ¨ç­‰å¾…åå•ä¸Šã€‚
#- èˆªç­ 3 çš„åº§ä½å®¹é‡ä¸º 1ã€‚ç”±äºŽæœ‰ 2 åä¹˜å®¢é¢„è®¢äº†æœºç¥¨ï¼Œåªæœ‰ 1 åä¹˜å®¢å¯ä»¥èŽ·å¾—åº§ä½ã€‚å› æ­¤ï¼Œæœ‰ 1 åä¹˜å®¢æˆåŠŸé¢„è®¢ï¼Œå¹¶ä¸”æœ‰ 1 åä¹˜å®¢åœ¨ç­‰å¾…åå•ä¸Šã€‚ 
#
# Related Topics æ•°æ®åº“ ðŸ‘ 0 ðŸ‘Ž 0

public class FlightOccupancyAndWaitlistAnalysis{
	public static void main(String[] args) {
		Solution solution = new FlightOccupancyAndWaitlistAnalysis().new Solution();
		
	}
#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below

select a.flight_id,if(count(passenger_id)>capacity,capacity,count(passenger_id)) booked_cnt,if(count(passenger_id)>capacity,count(passenger_id)-capacity,0) waitlist_cnt
from Flights a left join Passengers b on a.flight_id=b.flight_id
group by a.flight_id order by a.flight_id

#leetcode submit region end(Prohibit modification and deletion)

}
