package leetcode.editor.cn;

#è¡¨: Orders 
#
# 
#+--------------+------+
#| Column Name  | Type |
#+--------------+------+
#| order_id     | int  |
#| customer_id  | int  |
#| order_date   | date |
#| price        | int  |
#+--------------+------+
#order_id æ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
#æ¯è¡ŒåŒ…å«è®¢å•çš„ idã€è®¢è´­è¯¥è®¢å•çš„å®¢æˆ· idã€è®¢å•æ—¥æœŸå’Œä»·æ ¼ã€‚
# 
#
# 
#
# ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŠ¥å‘Š æ€»è´­ä¹°é‡ æ¯å¹´ä¸¥æ ¼å¢åŠ çš„å®¢æˆ· idã€‚ 
#
# 
# å®¢æˆ·åœ¨ä¸€å¹´å†…çš„ æ€»è´­ä¹°é‡ æ˜¯è¯¥å¹´è®¢å•ä»·æ ¼çš„æ€»å’Œã€‚å¦‚æœæŸä¸€å¹´å®¢æˆ·æ²¡æœ‰ä¸‹ä»»ä½•è®¢å•ï¼Œæˆ‘ä»¬è®¤ä¸ºæ€»è´­ä¹°é‡ä¸º 0ã€‚ 
# å¯¹äºæ¯ä¸ªå®¢æˆ·ï¼Œè¦è€ƒè™‘çš„ç¬¬ä¸€ä¸ªå¹´æ˜¯ä»–ä»¬ ç¬¬ä¸€æ¬¡ä¸‹å• çš„å¹´ä»½ã€‚ 
# å¯¹äºæ¯ä¸ªå®¢æˆ·ï¼Œè¦è€ƒè™‘çš„æœ€åä¸€å¹´æ˜¯ä»–ä»¬ æœ€åä¸€æ¬¡ä¸‹å• çš„å¹´ä»½ã€‚ 
# 
#
# ä»¥ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚ 
#
# æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚ 
#
# 
#
# ç¤ºä¾‹ 1: 
#
# 
#è¾“å…¥: 
#Orders è¡¨:
#+----------+-------------+------------+-------+
#| order_id | customer_id | order_date | price |
#+----------+-------------+------------+-------+
#| 1        | 1           | 2019-07-01 | 1100  |
#| 2        | 1           | 2019-11-01 | 1200  |
#| 3        | 1           | 2020-05-26 | 3000  |
#| 4        | 1           | 2021-08-31 | 3100  |
#| 5        | 1           | 2022-12-07 | 4700  |
#| 6        | 2           | 2015-01-01 | 700   |
#| 7        | 2           | 2017-11-07 | 1000  |
#| 8        | 3           | 2017-01-01 | 900   |
#| 9        | 3           | 2018-11-07 | 900   |
#+----------+-------------+------------+-------+
#è¾“å‡º: 
#+-------------+
#| customer_id |
#+-------------+
#| 1           |
#+-------------+
#è§£é‡Š: 
#å®¢æˆ· 1: ç¬¬ä¸€å¹´æ˜¯ 2019 å¹´ï¼Œæœ€åä¸€å¹´æ˜¯ 2022 å¹´
#  - 2019: 1100 + 1200 = 2300
#  - 2020: 3000
#  - 2021: 3100
#  - 2022: 4700
#  æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ€»è´­ä¹°é‡æ¯å¹´éƒ½åœ¨ä¸¥æ ¼å¢åŠ ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç­”æ¡ˆä¸­åŒ…å«äº†å®¢æˆ· 1ã€‚
#
#å®¢æˆ· 2: ç¬¬ä¸€å¹´æ˜¯2015å¹´ï¼Œæœ€åä¸€å¹´æ˜¯2017å¹´
#  - 2015: 700
#  - 2016: 0
#  - 2017: 1000
#  æˆ‘ä»¬æ²¡æœ‰æŠŠå®¢æˆ· 2 åŒ…æ‹¬åœ¨ç­”æ¡ˆä¸­ï¼Œå› ä¸ºæ€»çš„è´­ä¹°é‡å¹¶æ²¡æœ‰ä¸¥æ ¼åœ°å¢åŠ ã€‚è¯·æ³¨æ„ï¼Œå®¢æˆ· 2 åœ¨ 2016 å¹´æ²¡æœ‰è´­ä¹°ä»»ä½•ç‰©å“ã€‚
#
#å®¢æˆ· 3: ç¬¬ä¸€å¹´æ˜¯ 2017 å¹´ï¼Œæœ€åä¸€å¹´æ˜¯ 2018 å¹´
#  - 2017: 900
#  - 2018: 900 
#
# Related Topics æ•°æ®åº“ ğŸ‘ 1 ğŸ‘ 0

public class CustomersWithStrictlyIncreasingPurchases{
	public static void main(String[] args) {
		Solution solution = new CustomersWithStrictlyIncreasingPurchases().new Solution();
		
	}
#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below

with t as (
    select customer_id,year(order_date) year,ifnull(sum(price),0) price from Orders group by customer_id,year(order_date)
)

select t.customer_id from t left join t t1 on t.customer_id=t1.customer_id and t.year+1=t1.year
group by t.customer_id having sum(t.price<ifnull(t1.price,0))=count(t.customer_id)-1


#leetcode submit region end(Prohibit modification and deletion)

}
