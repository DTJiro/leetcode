package leetcode.editor.cn;

#è¡¨ï¼šOrders 
#
# 
#+---------------+---------+
#| Column Name   | Type    |
#+---------------+---------+
#| order_id      | int     |
#| order_date    | date    |
#| customer_id   | int     |
#| invoice       | int     |
#+---------------+---------+
#order_id æ˜¯ Orders è¡¨çš„ä¸»é”®ã€‚
#è¿™å¼ è¡¨åŒ…å«é¡¾å®¢(customer_id)æ‰€ä¸‹è®¢å•çš„ä¿¡æ¯ã€‚
# 
#
# 
#
# å†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥æ¥ æŒ‰æœˆ ç»Ÿè®¡é‡‘é¢ï¼ˆinvoiceï¼‰å¤§äºŽ $20 çš„å”¯ä¸€ è®¢å•æ•° å’Œå”¯ä¸€ é¡¾å®¢æ•° ã€‚ 
#
# æŸ¥è¯¢ç»“æžœæ— æŽ’åºè¦æ±‚ã€‚ 
#
# æŸ¥è¯¢ç»“æžœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚ 
#
# 
#
# ç¤ºä¾‹ 1ï¼š 
#
# 
#è¾“å…¥ï¼š
#Orders
#+----------+------------+-------------+------------+
#| order_id | order_date | customer_id | invoice    |
#+----------+------------+-------------+------------+
#| 1        | 2020-09-15 | 1           | 30         |
#| 2        | 2020-09-17 | 2           | 90         |
#| 3        | 2020-10-06 | 3           | 20         |
#| 4        | 2020-10-20 | 3           | 21         |
#| 5        | 2020-11-10 | 1           | 10         |
#| 6        | 2020-11-21 | 2           | 15         |
#| 7        | 2020-12-01 | 4           | 55         |
#| 8        | 2020-12-03 | 4           | 77         |
#| 9        | 2021-01-07 | 3           | 31         |
#| 10       | 2021-01-15 | 2           | 20         |
#+----------+------------+-------------+------------+
#è¾“å‡ºï¼š
#+---------+-------------+----------------+
#| month   | order_count | customer_count |
#+---------+-------------+----------------+
#| 2020-09 | 2           | 2              |
#| 2020-10 | 1           | 1              |
#| 2020-12 | 2           | 1              |
#| 2021-01 | 1           | 1              |
#+---------+-------------+----------------+
#è§£é‡Šï¼š
#åœ¨ 2020 å¹´ 09 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 2 ä½ä¸åŒé¡¾å®¢çš„é‡‘é¢å¤§äºŽ $20 çš„è®¢å•ã€‚
#åœ¨ 2020 å¹´ 10 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 1 ä½é¡¾å®¢çš„è®¢å•ï¼Œå¹¶ä¸”åªæœ‰å…¶ä¸­çš„ 1 ä»½è®¢å•é‡‘é¢å¤§äºŽ $20 ã€‚
#åœ¨ 2020 å¹´ 11 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 2 ä½ä¸åŒé¡¾å®¢çš„è®¢å•ï¼Œä½†ç”±äºŽé‡‘é¢éƒ½å°äºŽ $20 ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æŸ¥è¯¢ç»“æžœä¸­ä¸åŒ…å«è¿™ä¸ªæœˆçš„æ•°æ®ã€‚
#åœ¨ 2020 å¹´ 12 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 1 ä½é¡¾å®¢çš„è®¢å•ï¼Œä¸” 2 ä»½è®¢å•é‡‘é¢éƒ½å¤§äºŽ $20 ã€‚
#åœ¨ 2021 å¹´ 01 æœˆï¼Œæœ‰ 2 ä»½æ¥è‡ª 2 ä½ä¸åŒé¡¾å®¢çš„è®¢å•ï¼Œä½†åªæœ‰å…¶ä¸­ä¸€ä»½è®¢å•é‡‘é¢å¤§äºŽ $20 ã€‚ 
#
# Related Topics æ•°æ®åº“ ðŸ‘ 12 ðŸ‘Ž 0

public class UniqueOrdersAndCustomersPerMonth{
	public static void main(String[] args) {
		Solution solution = new UniqueOrdersAndCustomersPerMonth().new Solution();
		
	}
#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below

select date_format(order_date,'%Y-%m') month,count(order_id) order_count,count(distinct customer_id) customer_count from Orders
where invoice>20 group by date_format(order_date,'%Y-%m')

#leetcode submit region end(Prohibit modification and deletion)

}
