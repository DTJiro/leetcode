package leetcode.editor.cn;

#è¡¨: Drivers 
#
# 
#+-------------+---------+
#| Column Name | Type    |
#+-------------+---------+
#| driver_id   | int     |
#| join_date   | date    |
#+-------------+---------+
#driver_id æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡Œå‡åŒ…å«é©¾é©¶å‘˜çš„IDä»¥åŠä»–ä»¬åŠ å…¥Hopperå…¬å¸çš„æ—¥æœŸã€‚
# 
#
# 
#
# è¡¨: Rides 
#
# 
#+--------------+---------+
#| Column Name  | Type    |
#+--------------+---------+
#| ride_id      | int     |
#| user_id      | int     |
#| requested_at | date    |
#+--------------+---------+
#ride_id æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡Œå‡åŒ…å«è¡Œç¨‹ID(ride_id)ï¼Œç”¨æˆ·ID(user_id)ä»¥åŠè¯¥è¡Œç¨‹çš„æ—¥æœŸ(requested_at)ã€‚
#è¯¥è¡¨ä¸­å¯èƒ½æœ‰ä¸€äº›ä¸è¢«æ¥å—çš„ä¹˜è½¦è¯·æ±‚ã€‚
# 
#
# 
#
# è¡¨: AcceptedRides 
#
# 
#+---------------+---------+
#| Column Name   | Type    |
#+---------------+---------+
#| ride_id       | int     |
#| driver_id     | int     |
#| ride_distance | int     |
#| ride_duration | int     |
#+---------------+---------+
#ride_id æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«å·²æ¥å—çš„è¡Œç¨‹ä¿¡æ¯ã€‚
#è¡¨ä¸­çš„è¡Œç¨‹ä¿¡æ¯éƒ½åœ¨â€œRidesâ€è¡¨ä¸­å­˜åœ¨ã€‚
# 
#
# 
#
# ç¼–å†™è§£å†³æ–¹æ¡ˆä»¥æŠ¥å‘Š 2020 å¹´æ¯ä¸ªæœˆçš„ä»¥ä¸‹ç»Ÿè®¡ä¿¡æ¯ï¼š 
#
# 
# æˆªè‡³æŸæœˆåº•ï¼Œå½“å‰åœ¨Hopperå…¬å¸å·¥ä½œçš„é©¾é©¶å‘˜æ•°é‡ï¼ˆactive_driversï¼‰ã€‚ 
# è¯¥æœˆæ¥å—çš„ä¹˜è½¦æ¬¡æ•°ï¼ˆaccepted_ridesï¼‰ã€‚ 
# 
#
# è¿”å›æŒ‰month å‡åºæ’åˆ—çš„ç»“æœè¡¨ï¼Œå…¶ä¸­month æ˜¯æœˆä»½çš„æ•°å­—ï¼ˆä¸€æœˆæ˜¯1ï¼ŒäºŒæœˆæ˜¯2ï¼Œä¾æ­¤ç±»æ¨ï¼‰ã€‚ 
#
# è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚ 
#
# 
#
# ç¤ºä¾‹ 1ï¼š 
#
# 
#è¾“å…¥ï¼š
#è¡¨ Drivers:
#+-----------+------------+
#| driver_id | join_date  |
#+-----------+------------+
#| 10        | 2019-12-10 |
#| 8         | 2020-1-13  |
#| 5         | 2020-2-16  |
#| 7         | 2020-3-8   |
#| 4         | 2020-5-17  |
#| 1         | 2020-10-24 |
#| 6         | 2021-1-5   |
#+-----------+------------+
#è¡¨ Rides:
#+---------+---------+--------------+
#| ride_id | user_id | requested_at |
#+---------+---------+--------------+
#| 6       | 75      | 2019-12-9    |
#| 1       | 54      | 2020-2-9     |
#| 10      | 63      | 2020-3-4     |
#| 19      | 39      | 2020-4-6     |
#| 3       | 41      | 2020-6-3     |
#| 13      | 52      | 2020-6-22    |
#| 7       | 69      | 2020-7-16    |
#| 17      | 70      | 2020-8-25    |
#| 20      | 81      | 2020-11-2    |
#| 5       | 57      | 2020-11-9    |
#| 2       | 42      | 2020-12-9    |
#| 11      | 68      | 2021-1-11    |
#| 15      | 32      | 2021-1-17    |
#| 12      | 11      | 2021-1-19    |
#| 14      | 18      | 2021-1-27    |
#+---------+---------+--------------+
#è¡¨ AcceptedRides:
#+---------+-----------+---------------+---------------+
#| ride_id | driver_id | ride_distance | ride_duration |
#+---------+-----------+---------------+---------------+
#| 10      | 10        | 63            | 38            |
#| 13      | 10        | 73            | 96            |
#| 7       | 8         | 100           | 28            |
#| 17      | 7         | 119           | 68            |
#| 20      | 1         | 121           | 92            |
#| 5       | 7         | 42            | 101           |
#| 2       | 4         | 6             | 38            |
#| 11      | 8         | 37            | 43            |
#| 15      | 8         | 108           | 82            |
#| 12      | 8         | 38            | 34            |
#| 14      | 1         | 90            | 74            |
#+---------+-----------+---------------+---------------+
#è¾“å‡ºï¼š
#+-------+----------------+----------------+
#| month | active_drivers | accepted_rides |
#+-------+----------------+----------------+
#| 1     | 2              | 0              |
#| 2     | 3              | 0              |
#| 3     | 4              | 1              |
#| 4     | 4              | 0              |
#| 5     | 5              | 0              |
#| 6     | 5              | 1              |
#| 7     | 5              | 1              |
#| 8     | 5              | 1              |
#| 9     | 5              | 0              |
#| 10    | 6              | 0              |
#| 11    | 6              | 2              |
#| 12    | 6              | 1              |
#+-------+----------------+----------------+
#è§£é‡Šï¼š
#æˆªè‡³1æœˆåº•->ä¸¤ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
#æˆªè‡³2æœˆåº•->ä¸‰ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
#æˆªè‡³3æœˆåº•->å››ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7ï¼‰ï¼Œä¸€ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ10ï¼‰ã€‚
#æˆªè‡³4æœˆåº•->å››ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
#æˆªè‡³5æœˆåº•->äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
#æˆªè‡³6æœˆåº•->äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œä¸€ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ13ï¼‰ã€‚
#æˆªè‡³7æœˆåº•->äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œä¸€ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ7ï¼‰ã€‚
#æˆªè‡³8æœˆåº•->äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œä¸€ä½æ¥å—çš„è¡Œç¨‹ï¼ˆ17ï¼‰ã€‚
#æˆªè‡³9æœˆåº•->äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
#æˆªè‡³10æœˆåº•->å…­ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4,1ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
#æˆªè‡³11æœˆåº•->å…­ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4,1ï¼‰ï¼Œä¸¤ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ20,5ï¼‰ã€‚
#æˆªè‡³12æœˆåº•->å…­ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4,1ï¼‰ï¼Œä¸€ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ2ï¼‰ã€‚ 
#
# Related Topics æ•°æ®åº“ ğŸ‘ 20 ğŸ‘ 0

public class HopperCompanyQueriesI{
	public static void main(String[] args) {
		Solution solution = new HopperCompanyQueriesI().new Solution();
		
	}
#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below

with recursive n as (
select '2020-01-31' date
union
select adddate(date,interval 1 month) date from n where month(date)<12
)

select d.month,ifnull(d.count,0) active_drivers,ifnull(g.count,0) accepted_rides from
(select month(b.date) month,count(DISTINCT c.driver_id) count from
(select if( a.join_date>n.date,a.join_date,n.date ) date,a.driver_id from n n
left join Drivers a on date_format(n.date,'%Y-%m')=date_format(a.join_date,'%Y-%m')) b left join Drivers c
on b.date>=c.join_date and year(b.date)=2020 group by month(b.date)) d
left join (select month(requested_at) month,count(*) count from (select * from Rides where YEAR(requested_at)=2020) e
inner join AcceptedRides f on e.ride_id=f.ride_id group by month(requested_at)) g on g.month=d.month
order by d.month

#leetcode submit region end(Prohibit modification and deletion)

}
