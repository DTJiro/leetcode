### æ–¹ä¾¿å¿«é€Ÿå­¦ä¹ ç®—æ³•ä¸ç†è§£~

ğŸŒ‡ ç‚¹èµ ğŸ‘ æ”¶è— â­ç•™è¨€ ğŸ“ ä¸€é”®ä¸‰è¿ ~å…³æ³¨Jamï¼Œä»ä½ æˆ‘åšèµ·ï¼

**å…„å¼Ÿä¼šèƒŒå›ä½ ï¼Œå¥³äººä¼šç¦»å¼€ä½ ï¼Œé‡‘é’±ä¼šè¯±æƒ‘ä½ ï¼Œç”Ÿæ´»ä¼šåˆéš¾ä½ ï¼Œåªæœ‰æ•°å­¦ä¸ä¼šï¼Œä¸ä¼šå°±æ˜¯ä¸ä¼š**
**å¤©æ‰ä¸å¦ï¼Œå–å†³äºæœ€ç»ˆè¾¾åˆ°çš„é«˜åº¦ã€‚çœŸæ­£çš„å¤©æ‰æ˜¯é‚£äº›è„šè¸å®åœ°çš„äºº**
**é™ä¸‹å¿ƒæ¥å¥½å¥½åšè‡ªå·±ï¼Œèµ°ç¨³è„šä¸‹æ¯ä¸€æ­¥ï¼Œå°±æ˜¯æœ€å¥½çš„è·¯ï¼Œå¼ºè€…éƒ½æ˜¯å­¤ç‹¬çš„**

æ¨è python ç®—æ³•çš„ä¹¦ç±ï¼Œä½“ç³»åŒ–å­¦ä¹ ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œç”¨æ­£ç¡®çš„æ–¹å¼æˆä¸ºofferæ”¶å‰²æœº
[leetcode](https://github.com/ls1248659692/leetcode) â€”â€”  **ç³»ç»ŸåŒ–å¿«é€Ÿå­¦ä¹ ç®—æ³•ï¼Œè¿™ä¸æ˜¯å†…å·ï¼Œè¿™åªæ˜¯æ‚„æ‚„åœ°åŠªåŠ›ï¼Œç„¶åæƒŠè‰³æ‰€æœ‰çš„äºº**
![image.png](https://pic.leetcode-cn.com/1649771039-XYXnfg-image.png)

---

### æ±‚è§£æ€è·¯

1. æ„å»ºæ¯ä¸ªç”¨æˆ·çš„è´­ä¹°æ•°æ®æŒ‰å¤©èšåˆ

* 

```
SELECT 
	user_id,
	spend_date, 
	any_value(if(count(platform) = 2, 'both', platform)) platform,
	sum(amount) amount
FROM spending
GROUP BY user_id, spend_date
```

2. æ„å»ºæ¯å¤©æ•°æ®çš„å…¶ä»–ä¸‰ä¸ªæ¯ç±»æ•°æ®

* 

```
SELECT 'mobile' platform union 
SELECT 'desktop' platform union
SELECT 'both' platform 
```

3. åˆ¤æ–­æ±‚å’Œ total_amount å’Œ total_users çš„æ¡ä»¶

* 

```
sum(if(t1.platform = t2.platform, amount, 0)) total_amount
count(if(t1.platform = t2.platform, 1, NULL)) total_users
```

### ä»£ç 

* mysql

```mysql
# Write your MySQL query statement below
SELECT 
	t2.spend_date,
	t1.platform,
    # t2.platform,
	sum(if(t1.platform = t2.platform, amount, 0)) total_amount,
	count(if(t1.platform = t2.platform, 1, NULL)) total_users
FROM (
	SELECT 'mobile' platform union 
    SELECT 'desktop' platform union
	SELECT 'both' platform 
) t1, 
(
	SELECT 
		user_id,
		spend_date, 
		any_value(if(count(platform) = 2, 'both', platform)) platform,
		sum(amount) amount
	FROM spending
	GROUP BY user_id, spend_date
) t2 
GROUP BY t2.spend_date, t1.platform;
```

