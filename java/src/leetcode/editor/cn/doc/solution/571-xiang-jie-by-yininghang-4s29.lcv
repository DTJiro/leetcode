### 解题思路

1. USE SUM, WHERE ASCENDING SUM BETWEEN DESCENDING SUM MINUS FREQUENCY AND PLUS FREQUENCY;

### 代码

* mysql

```mysql
SELECT AVG(NUMBER) AS MEDIAN
FROM (SELECT *, SUM(FREQUENCY) OVER(ORDER BY NUMBER) AS S1, SUM(FREQUENCY) OVER(ORDER BY NUMBER DESC) AS S2
      FROM NUMBERS) AS A
WHERE S1 BETWEEN S2 - FREQUENCY AND S2 + FREQUENCY;
```

