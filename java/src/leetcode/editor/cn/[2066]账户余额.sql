package leetcode.editor.cn;

#è¡¨å: Transactions 
#
# 
#+-------------+------+
#| Column Name | Type |
#+-------------+------+
#| account_id  | int  |
#| day         | date |
#| type        | ENUM |
#| amount      | int  |
#+-------------+------+
#(account_id, day) æ˜¯è¯¥Transactionsè¡¨çš„ä¸»é”®.
#è¡¨ä¸­çš„æ¯è¡Œæ•°æ®è¡¨ç¤ºä¸€æ¬¡äº¤æ˜“çš„ä¿¡æ¯, åŒ…æ‹¬æ­¤æ¬¡äº¤æ˜“çš„è´¦å·(account_id), äº¤æ˜“ç±»å‹(type), äº¤æ˜“å‘ç”Ÿæ—¶é—´(day), äº¤æ˜“å‘ç”Ÿé‡‘é¢(
#amount).
#å…¶ä¸­äº¤æ˜“ç±»å‹(type)å­—æ®µåŒ…æ‹¬äº†ä¸¤ç§è¡Œä¸ºï¼šå­˜å…¥ ('Deposit'), å–å‡º('Withdraw').
# 
#
# 
#
# è¯·å†™å‡ºèƒ½å¤Ÿè¿”å›ç”¨æˆ·æ¯æ¬¡äº¤æ˜“å®Œæˆåçš„è´¦æˆ·ä½™é¢. æˆ‘ä»¬çº¦å®šæ‰€æœ‰ç”¨æˆ·åœ¨è¿›è¡Œäº¤æ˜“å‰çš„è´¦æˆ·ä½™é¢éƒ½ä¸º0ï¼Œ å¹¶ä¸”ä¿è¯æ‰€æœ‰äº¤æ˜“è¡Œä¸ºåçš„ä½™é¢ä¸ä¸ºè´Ÿæ•°ã€‚ 
#
# è¿”å›çš„ç»“æœè¯·ä¾æ¬¡æŒ‰ç…§ è´¦æˆ·ï¼ˆaccount_id), æ—¥æœŸ( day ) è¿›è¡Œå‡åºæ’åº . 
#
# æŸ¥è¯¢ç»“æœçš„æ ¼å¼è¯·å‚ç…§ä»¥ä¸‹æµ‹è¯•æ ·ä¾‹. 
#
# 
#
# æµ‹è¯•æ ·ä¾‹1: 
#
# 
#è¾“å…¥: 
#Transactions è¡¨:
#+------------+------------+----------+--------+
#| account_id | day        | type     | amount |
#+------------+------------+----------+--------+
#| 1          | 2021-11-07 | Deposit  | 2000   |
#| 1          | 2021-11-09 | Withdraw | 1000   |
#| 1          | 2021-11-11 | Deposit  | 3000   |
#| 2          | 2021-12-07 | Deposit  | 7000   |
#| 2          | 2021-12-12 | Withdraw | 7000   |
#+------------+------------+----------+--------+
#è¾“å‡º: 
#+------------+------------+---------+
#| account_id | day        | balance |
#+------------+------------+---------+
#| 1          | 2021-11-07 | 2000    |
#| 1          | 2021-11-09 | 1000    |
#| 1          | 2021-11-11 | 4000    |
#| 2          | 2021-12-07 | 7000    |
#| 2          | 2021-12-12 | 0       |
#+------------+------------+---------+
#
#è§£é‡Š: 
#è´¦æˆ·1:
#- åˆå§‹é‡‘é¢ä¸º 0.
#- 2021-11-07 --> å­˜å…¥2000. ä½™é¢å˜ä¸º 0 + 2000 = 2000.
#- 2021-11-09 --> å–å‡º1000. ä½™é¢å˜ä¸º 2000 - 1000 = 1000.
#- 2021-11-11 --> å­˜å…¥3000. ä½™é¢å˜ä¸º 1000 + 3000 = 4000.
#è´¦æˆ·2:
#- åˆå§‹é‡‘é¢ä¸º 0.
#- 2021-12-07 --> å­˜å…¥7000. ä½™é¢å˜ä¸º 0 + 7000 = 7000.
#- 2021-12-12 --> å–å‡º 7000. ä½™é¢å˜ä¸º 7000 - 7000 = 0.
# 
#
# Related Topics æ•°æ®åº“ ğŸ‘ 5 ğŸ‘ 0

public class AccountBalance{
	public static void main(String[] args) {
		Solution solution = new AccountBalance().new Solution();
		
	}
#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below

select account_id,day,sum(if(type='Deposit',amount,-amount)) over(partition by account_id order by day) balance from Transactions
order by account_id,day

#leetcode submit region end(Prohibit modification and deletion)

}
