package leetcode.editor.cn;

#è¡¨: Drivers 
#
# +-------------+---------+
#| Column Name | Type Â  Â |
#+-------------+---------+
#| driver_id Â  | int Â  Â  |
#| join_date Â  | date Â  Â |
#+-------------+---------+
#driver_idæ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡Œå‡åŒ…å«é©¾é©¶å‘˜çš„IDä»¥åŠä»–ä»¬åŠ å…¥Hopperå…¬å¸çš„æ—¥æœŸã€‚
# 
#
# 
#
# è¡¨: Rides 
#
# +--------------+---------+
#| Column Name Â | Type Â  Â |
#+--------------+---------+
#| ride_id Â  Â  Â | int Â  Â  |
#| user_id Â  Â  Â | int Â  Â  |
#| requested_at | date Â  Â |
#+--------------+---------+
#ride_idæ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡Œå‡åŒ…å«è¡Œç¨‹ID(ride_id)ï¼Œç”¨æˆ·ID(user_id)ä»¥åŠè¯¥è¡Œç¨‹çš„æ—¥æœŸ(requested_at)ã€‚
#è¯¥è¡¨ä¸­å¯èƒ½æœ‰ä¸€äº›ä¸è¢«æ¥å—çš„ä¹˜è½¦è¯·æ±‚ã€‚ 
#
# 
#
# è¡¨: AcceptedRides 
#
# +---------------+---------+
#| Column Name Â  | Type Â  Â |
#+---------------+---------+
#| ride_id Â  Â  Â  | int Â  Â  |
#| driver_id Â  Â  | int Â  Â  |
#| ride_distance | int Â  Â  |
#| ride_duration | int Â  Â  |
#+---------------+---------+
#ride_idæ˜¯è¯¥è¡¨çš„ä¸»é”®ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«å·²æ¥å—çš„è¡Œç¨‹ä¿¡æ¯ã€‚
#è¡¨ä¸­çš„è¡Œç¨‹ä¿¡æ¯éƒ½åœ¨â€œRidesâ€è¡¨ä¸­å­˜åœ¨ã€‚
# 
#
# 
#
# ç¼–å†™SQLæŸ¥è¯¢ä»¥æŠ¥å‘Š2020å¹´æ¯ä¸ªæœˆçš„å·¥ä½œé©±åŠ¨å› ç´ ç™¾åˆ†æ¯”ï¼ˆworking_percentageï¼‰ï¼Œå…¶ä¸­ï¼š 
# 
#
# æ³¨æ„ï¼šå¦‚æœä¸€ä¸ªæœˆå†…å¯ç”¨é©¾é©¶å‘˜çš„æ•°é‡ä¸ºé›¶ï¼Œæˆ‘ä»¬è®¤ä¸ºworking_percentageä¸º0ã€‚ 
#
# è¿”å›æŒ‰monthå‡åºæ’åˆ—çš„ç»“æœè¡¨ï¼Œå…¶ä¸­monthæ˜¯æœˆä»½çš„ç¼–å·ï¼ˆä¸€æœˆæ˜¯1ï¼ŒäºŒæœˆæ˜¯2ï¼Œç­‰ç­‰ï¼‰ã€‚å°†working_percentageå››èˆäº”å…¥è‡³å°æ•°ç‚¹åä¸¤ä½ã€‚ 
#
# æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚ 
#
# æ¡ˆä¾‹ 1: 
#
# è¡¨ Drivers:
#+-----------+------------+
#| driver_id | join_date Â |
#+-----------+------------+
#| 10 Â  Â  Â  Â | 2019-12-10 |
#| 8 Â  Â  Â  Â  | 2020-1-13 Â |
#| 5 Â  Â  Â  Â  | 2020-2-16 Â |
#| 7 Â  Â  Â  Â  | 2020-3-8 Â  |
#| 4 Â  Â  Â  Â  | 2020-5-17 Â |
#| 1 Â  Â  Â  Â  | 2020-10-24 |
#| 6 Â  Â  Â  Â  | 2021-1-5 Â  |
#+-----------+------------+
#
#è¡¨ Rides:
#+---------+---------+--------------+
#| ride_id | user_id | requested_at |
#+---------+---------+--------------+
#| 6 Â  Â  Â  | 75 Â  Â  Â | 2019-12-9 Â  Â |
#| 1 Â  Â  Â  | 54 Â  Â  Â | 2020-2-9 Â  Â  |
#| 10 Â  Â  Â | 63 Â  Â  Â | 2020-3-4 Â  Â  |
#| 19 Â  Â  Â | 39 Â  Â  Â | 2020-4-6 Â  Â  |
#| 3 Â  Â  Â  | 41 Â  Â  Â | 2020-6-3 Â  Â  |
#| 13 Â  Â  Â | 52 Â  Â  Â | 2020-6-22 Â  Â |
#| 7 Â  Â  Â  | 69 Â  Â  Â | 2020-7-16 Â  Â |
#| 17 Â  Â  Â | 70 Â  Â  Â | 2020-8-25 Â  Â |
#| 20 Â  Â  Â | 81 Â  Â  Â | 2020-11-2 Â  Â |
#| 5 Â  Â  Â  | 57 Â  Â  Â | 2020-11-9 Â  Â |
#| 2 Â  Â  Â  | 42 Â  Â  Â | 2020-12-9 Â  Â |
#| 11 Â  Â  Â | 68 Â  Â  Â | 2021-1-11 Â  Â |
#| 15 Â  Â  Â | 32 Â  Â  Â | 2021-1-17 Â  Â |
#| 12 Â  Â  Â | 11 Â  Â  Â | 2021-1-19 Â  Â |
#| 14 Â  Â  Â | 18 Â  Â  Â | 2021-1-27 Â  Â |
#+---------+---------+--------------+
#
#è¡¨ AcceptedRides:
#+---------+-----------+---------------+---------------+
#| ride_id | driver_id | ride_distance | ride_duration |
#+---------+-----------+---------------+---------------+
#| 10 Â  Â  Â | 10 Â  Â  Â  Â | 63 Â  Â  Â  Â  Â  Â | 38 Â  Â  Â  Â  Â  Â |
#| 13 Â  Â  Â | 10 Â  Â  Â  Â | 73 Â  Â  Â  Â  Â  Â | 96 Â  Â  Â  Â  Â  Â |
#| 7 Â  Â  Â  | 8 Â  Â  Â  Â  | 100 Â  Â  Â  Â  Â  | 28 Â  Â  Â  Â  Â  Â |
#| 17 Â  Â  Â | 7 Â  Â  Â  Â  | 119 Â  Â  Â  Â  Â  | 68 Â  Â  Â  Â  Â  Â |
#| 20 Â  Â  Â | 1 Â  Â  Â  Â  | 121 Â  Â  Â  Â  Â  | 92 Â  Â  Â  Â  Â  Â |
#| 5 Â  Â  Â  | 7 Â  Â  Â  Â  | 42 Â  Â  Â  Â  Â  Â | 101 Â  Â  Â  Â  Â  |
#| 2 Â  Â  Â  | 4 Â  Â  Â  Â  | 6 Â  Â  Â  Â  Â  Â  | 38 Â  Â  Â  Â  Â  Â |
#| 11 Â  Â  Â | 8 Â  Â  Â  Â  | 37 Â  Â  Â  Â  Â  Â | 43 Â  Â  Â  Â  Â  Â |
#| 15 Â  Â  Â | 8 Â  Â  Â  Â  | 108 Â  Â  Â  Â  Â  | 82 Â  Â  Â  Â  Â  Â |
#| 12 Â  Â  Â | 8 Â  Â  Â  Â  | 38 Â  Â  Â  Â  Â  Â | 34 Â  Â  Â  Â  Â  Â |
#| 14 Â  Â  Â | 1 Â  Â  Â  Â  | 90 Â  Â  Â  Â  Â  Â | 74 Â  Â  Â  Â  Â  Â |
#+---------+-----------+---------------+---------------+
#
#ç»“æœè¡¨:
#+-------+--------------------+
#| month | working_percentage |
#+-------+--------------------+
#| 1 Â  Â  | 0.00 Â  Â  Â  Â  Â  Â  Â  |
#| 2 Â  Â  | 0.00 Â  Â  Â  Â  Â  Â  Â  |
#| 3 Â  Â  | 25.00 Â  Â  Â  Â  Â  Â  Â |
#| 4 Â  Â  | 0.00 Â  Â  Â  Â  Â  Â  Â  |
#| 5 Â  Â  | 0.00 Â  Â  Â  Â  Â  Â  Â  |
#| 6 Â  Â  | 20.00 Â  Â  Â  Â  Â  Â  Â |
#| 7 Â  Â  | 20.00 Â  Â  Â  Â  Â  Â  Â |
#| 8 Â  Â  | 20.00 Â  Â  Â  Â  Â  Â  Â |
#| 9 Â  Â  | 0.00 Â  Â  Â  Â  Â  Â  Â  |
#| 10 Â  Â | 0.00 Â  Â  Â  Â  Â  Â  Â  |
#| 11 Â  Â | 33.33 Â  Â  Â  Â  Â  Â  Â |
#| 12 Â  Â | 16.67 Â  Â  Â  Â  Â  Â  Â |
#+-------+--------------------+
#
#æˆªè‡³1æœˆåº• --> 2ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8)ï¼Œæ— è¢«æ¥å—çš„è¡Œç¨‹ã€‚ç™¾åˆ†æ¯”æ˜¯0%ã€‚
#æˆªè‡³2æœˆåº• --> 3ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5)ï¼Œæ— è¢«æ¥å—çš„è¡Œç¨‹ã€‚ç™¾åˆ†æ¯”æ˜¯0%ã€‚
#æˆªè‡³3æœˆåº• --> 4ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7)ï¼Œ1ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ (10)ã€‚ç™¾åˆ†æ¯”æ˜¯ (1 / 4) * 100 = 25%ã€‚
#æˆªè‡³4æœˆåº• --> 4ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7)ï¼Œæ— è¢«æ¥å—çš„è¡Œç¨‹ã€‚ç™¾åˆ†æ¯”æ˜¯ 0%ã€‚
#æˆªè‡³5æœˆåº• --> 5ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7, 4)ï¼Œæ— è¢«æ¥å—çš„è¡Œç¨‹ã€‚ç™¾åˆ†æ¯”æ˜¯ 0%ã€‚
#æˆªè‡³6æœˆåº• --> 5ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7, 4)ï¼Œ1ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ (10)ã€‚ ç™¾åˆ†æ¯”æ˜¯ (1 / 5) * 100 = 20%ã€‚
#æˆªè‡³7æœˆåº• --> 5ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7, 4)ï¼Œ1ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ (8)ã€‚ç™¾åˆ†æ¯”æ˜¯ (1 / 5) * 100 = 20%ã€‚
#æˆªè‡³8æœˆåº• --> 5ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7, 4)ï¼Œ1ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ (7)ã€‚ç™¾åˆ†æ¯”æ˜¯ (1 / 5) * 100 = 20%ã€‚
#æˆªè‡³9æœˆåº• --> 5ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7, 4)ï¼Œæ— è¢«æ¥å—çš„è¡Œç¨‹ã€‚ç™¾åˆ†æ¯”æ˜¯ 0%ã€‚
#æˆªè‡³10æœˆåº• --> 6ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7, 4, 1) æ— è¢«æ¥å—çš„è¡Œç¨‹ã€‚ç™¾åˆ†æ¯”æ˜¯ 0%ã€‚
#æˆªè‡³11æœˆåº• --> 6ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7, 4, 1)ï¼Œ2ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ (1, 7)ã€‚ç™¾åˆ†æ¯”æ˜¯ (2 / 6) * 100 = 33
#.33%ã€‚
#æˆªè‡³12æœˆåº• --> 6ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ (10, 8, 5, 7, 4, 1)ï¼Œ1ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ (4)ã€‚ç™¾åˆ†æ¯”æ˜¯ (1 / 6) * 100 = 16.67
#%ã€‚
# 
#
# Related Topics æ•°æ®åº“ ğŸ‘ 5 ğŸ‘ 0

public class HopperCompanyQueriesIi{
	public static void main(String[] args) {
		Solution solution = new HopperCompanyQueriesIi().new Solution();
		
	}
#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below

with recursive t as (
select 1 n
union
select n+1 n from t where n<12
)
select t.n month,if(ifnull(max(num) over(order by t.n),0)=0,0,round(count(distinct c.driver_id)/max(num)*100,2)) working_percentage
from t left join (select join_date,count(driver_id) over(order by join_date) num from Drivers) a
                 on t.n>=month(a.join_date) and year(a.join_date)=2020
    left join Rides b on t.n=month(b.requested_at) and year(b.requested_at)=2020
    left join AcceptedRides c on c.ride_id=b.ride_id
group by t.n
order by month

-- with recursive t(n) as (
--     select 1 n
--     union all
--     select n+1 from t where n < 12
-- )
-- select t.n as month, ifnull(round(count(distinct AcceptedRides.driver_id) / max(cnt) * 100,2), 0) as working_percentage
-- from t
--     left join
--     (select join_date, count(driver_id) over(order by join_date) as cnt from Drivers) a
-- on t.n >= month(join_date) and year(join_date) = 2020
--     left join Rides on month(requested_at) = t.n and year(requested_at) = 2020
--     left join AcceptedRides on AcceptedRides.ride_id = Rides.ride_id
-- group by t.n


#leetcode submit region end(Prohibit modification and deletion)

}
