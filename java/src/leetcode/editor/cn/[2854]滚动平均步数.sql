package leetcode.editor.cn;

#è¡¨ï¼š Steps 
#
# 
#+-------------+------+ 
#| Column Name | Type | 
#+-------------+------+ 
#| user_id     | int  | 
#| steps_count | int  |
#| steps_date  | date |
#+-------------+------+
#(user_id, steps_date) æ˜¯æ­¤è¡¨çš„ä¸»é”®ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å« user_idã€steps_count å’Œ steps_dateã€‚
# 
#
# ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œè®¡ç®—å‡ºæ¯ä¸ªç”¨æˆ·çš„ 3-day æ»šåŠ¨å¹³å‡æ­¥æ•° ã€‚ 
#
# è®¡ç®— n-day æ»šåŠ¨å¹³å‡å€¼ çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š 
#
# 
# å¯¹äºæ¯ä¸€å¤©ï¼Œå¦‚æœæœ‰å¯ç”¨æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šè®¡ç®—ä»¥è¯¥å¤©ä¸ºç»“æŸçš„ n å¤©è¿ç»­æ­¥æ•°çš„å¹³å‡å€¼ï¼Œå¦åˆ™ï¼Œå¯¹äºè¯¥å¤©æ¥è¯´ï¼Œn å¤©æ»šåŠ¨å¹³å‡æ­¥æ•°æ˜¯æœªå®šä¹‰çš„ã€‚ 
# 
#
# è¾“å‡º user_id ã€ steps_date å’Œæ»šåŠ¨å¹³å‡å€¼ã€‚å¹¶å°†æ»šåŠ¨å¹³å‡å€¼å››èˆäº”å…¥åˆ° ä¸¤ä½å°æ•°ã€‚ 
#
# è¿”å›ç»“æœè¡¨ä»¥user_id å’Œ steps_date å‡åº æ’åºã€‚ 
#
# ç»“æœçš„æ ¼å¼å¦‚ä¸‹ç¤ºä¾‹ã€‚ 
#
# 
#
# ç¤ºä¾‹ 1: 
#
# 
#è¾“å…¥ï¼š
#Steps table:
#+---------+-------------+------------+
#| user_id | steps_count | steps_date |
#+---------+-------------+------------+
#| 1       | 687         | 2021-09-02 |
#| 1       | 395         | 2021-09-04 |
#| 1       | 499         | 2021-09-05 |
#| 1       | 712         | 2021-09-06 |
#| 1       | 576         | 2021-09-07 |
#| 2       | 153         | 2021-09-06 |
#| 2       | 171         | 2021-09-07 |
#| 2       | 530         | 2021-09-08 |
#| 3       | 945         | 2021-09-04 |
#| 3       | 120         | 2021-09-07 |
#| 3       | 557         | 2021-09-08 |
#| 3       | 840         | 2021-09-09 |
#| 3       | 627         | 2021-09-10 |
#| 5       | 382         | 2021-09-05 |
#| 6       | 480         | 2021-09-01 |
#| 6       | 191         | 2021-09-02 |
#| 6       | 303         | 2021-09-05 |
#+---------+-------------+------------+
#è¾“å‡ºï¼š
#+---------+------------+-----------------+
#| user_id | steps_date | rolling_average | 
#+---------+------------+-----------------+
#| 1       | 2021-09-06 | 535.33          | 
#| 1       | 2021-09-07 | 595.67          | 
#| 2       | 2021-09-08 | 284.67          |
#| 3       | 2021-09-09 | 505.67          |
#| 3       | 2021-09-10 | 674.67          |    
#+---------+------------+-----------------+
#è§£é‡Šï¼š
#- å¯¹äº ID ä¸º 1 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-06 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (395 + 499 + 712) / 3
# = 535.33ã€‚
#- å¯¹äº ID ä¸º 1 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-07 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (499 + 712 + 576) / 3
# = 595.67ã€‚
#- å¯¹äº ID ä¸º 2 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-08 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (153 + 171 + 530) / 3
# = 284.67ã€‚
#- å¯¹äº ID ä¸º 3 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-09 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (120 + 557 + 840) / 3
# = 505.67ã€‚
#- å¯¹äº ID ä¸º 3 çš„ç”¨æˆ·ï¼Œæˆªæ­¢åˆ° 2021-09-10 çš„ä¸‰å¤©è¿ç»­çš„æ­¥æ•°å¯ç”¨ã€‚å› æ­¤ï¼Œè¯¥æ—¥æœŸçš„æ»šåŠ¨å¹³å‡å€¼è®¡ç®—ä¸º (557 + 840 + 627) / 3
# = 674.67ã€‚
#- å¯¹äº ID ä¸º 4 å’Œ 5 çš„ç”¨æˆ·ï¼Œç”±äºè¿ç»­ä¸‰å¤©çš„æ•°æ®ä¸è¶³ï¼Œæ— æ³•è®¡ç®—æ»šåŠ¨å¹³å‡å€¼ã€‚ç»“æœè¡¨æŒ‰ user_id å’Œ steps_date å‡åºæ’åºã€‚ 
#
# Related Topics æ•°æ®åº“ ğŸ‘ 0 ğŸ‘ 0

public class RollingAverageSteps{
	public static void main(String[] args) {
		Solution solution = new RollingAverageSteps().new Solution();
		
	}
#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below

select a.user_id,a.steps_date,round(avg(b.steps_count),2) rolling_average from Steps a join Steps b on a.user_id=b.user_id and
datediff(a.steps_date,b.steps_date) between 0 and 2
group by a.user_id,a.steps_date having count(b.steps_date)=3
order by a.user_id,a.steps_date

#leetcode submit region end(Prohibit modification and deletion)

}
