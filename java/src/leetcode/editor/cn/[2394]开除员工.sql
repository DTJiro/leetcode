package leetcode.editor.cn;

#è¡¨: Employees
#
#
#+--------------+------+
#| Column Name  | Type |
#+--------------+------+
#| employee_id  | int  |
#| needed_hours | int  |
#+--------------+------+
#employee_id æ˜¯è¯¥è¡¨å…·æœ‰çš„å”¯ä¸€å€¼çš„åˆ—ã€‚
#æ¯ä¸€è¡Œéƒ½åŒ…å«å‘˜å·¥çš„ id å’Œä»–ä»¬èŽ·å¾—å·¥èµ„æ‰€éœ€çš„æœ€ä½Žå·¥ä½œæ—¶æ•°ã€‚
#
#
#
#
# è¡¨: Logs 
#
# 
#+-------------+----------+
#| Column Name | Type     |
#+-------------+----------+
#| employee_id | int      |
#| in_time     | datetime |
#| out_time    | datetime |
#+-------------+----------+
#(employee_id, in_time, out_time) æ˜¯è¯¥è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆï¼‰ã€‚
#è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½æ˜¾ç¤ºäº†å‘˜å·¥çš„æ—¶é—´æˆ³ã€‚in_time æ˜¯å‘˜å·¥å¼€å§‹å·¥ä½œçš„æ—¶é—´ï¼Œout_time æ˜¯å‘˜å·¥ç»“æŸå·¥ä½œçš„æ—¶é—´ã€‚
#æ‰€æœ‰æ—¶é—´éƒ½åœ¨ 2022 å¹´ 10 æœˆã€‚out_time å¯ä»¥æ˜¯ in_time ä¹‹åŽçš„ä¸€å¤©ï¼Œè¿™æ„å‘³ç€è¯¥å‘˜å·¥åœ¨åˆå¤œä¹‹åŽå·¥ä½œã€‚
# 
#
# 
#
# åœ¨å…¬å¸é‡Œï¼Œæ¯ä¸ªå‘˜å·¥æ¯ä¸ªæœˆå¿…é¡»å·¥ä½œä¸€å®šçš„å°æ—¶æ•°ã€‚å‘˜å·¥åœ¨å·¥ä½œæ®µä¸­å·¥ä½œã€‚å‘˜å·¥å·¥ä½œçš„å°æ—¶æ•°å¯ä»¥é€šè¿‡å‘˜å·¥åœ¨æ‰€æœ‰å·¥ä½œæ®µä¸­å·¥ä½œçš„åˆ†é’Ÿæ•°çš„æ€»å’Œæ¥è®¡ç®—ã€‚æ¯ä¸ªå·¥ä½œæ®µçš„åˆ†é’Ÿæ•°æ˜¯å‘
#ä¸Šå–æ•´çš„ã€‚ 
#
# 
# ä¾‹å¦‚ï¼Œå¦‚æžœå‘˜å·¥åœ¨ä¸€ä¸ªæ—¶é—´æ®µä¸­å·¥ä½œäº† 51 åˆ† 2 ç§’ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå®ƒæ˜¯ 52 åˆ†é’Ÿã€‚ 
# 
#
# ç¼–å†™è§£å†³æ–¹æ¡ˆæ¥æŠ¥å‘Šå°†è¢«å¼€é™¤çš„å‘˜å·¥çš„ idã€‚æ¢å¥è¯è¯´ï¼ŒæŠ¥å‘Šæ²¡æœ‰å·¥ä½œæ‰€éœ€æ—¶é—´çš„å‘˜å·¥çš„ idã€‚ 
#
# ä»¥ ä»»æ„é¡ºåº è¿”å›žç»“æžœè¡¨ã€‚ 
#
# ç»“æžœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚ 
#
# 
#
# ç¤ºä¾‹ 1: 
#
# 
#è¾“å…¥: 
#Employees è¡¨:
#+-------------+--------------+
#| employee_id | needed_hours |
#+-------------+--------------+
#| 1           | 20           |
#| 2           | 12           |
#| 3           | 2            |
#+-------------+--------------+
#Logs è¡¨:
#+-------------+---------------------+---------------------+
#| employee_id | in_time             | out_time            |
#+-------------+---------------------+---------------------+
#| 1           | 2022-10-01 09:00:00 | 2022-10-01 17:00:00 |
#| 1           | 2022-10-06 09:05:04 | 2022-10-06 17:09:03 |
#| 1           | 2022-10-12 23:00:00 | 2022-10-13 03:00:01 |
#| 2           | 2022-10-29 12:00:00 | 2022-10-29 23:58:58 |
#+-------------+---------------------+---------------------+
#è¾“å‡º: 
#+-------------+
#| employee_id |
#+-------------+
#| 2           |
#| 3           |
#+-------------+
#è§£é‡Š: 
#å‘˜å·¥ 1:
# - å‚åŠ äº†ä¸‰ä¸ªå·¥ä½œæ®µ:
#    - åœ¨ 2022-10-01, ä»–å·¥ä½œäº† 8 ä¸ªå°æ—¶ã€‚
#    - åœ¨ 2022-10-06, ä»–å·¥ä½œäº† 8 å°æ—¶ 4 åˆ†é’Ÿã€‚
#    - åœ¨ 2022-10-12, ä»–å·¥ä½œäº† 4 å°æ—¶ 1 åˆ†é’Ÿã€‚è¯·æ³¨æ„ï¼Œä»–ä¸€ç›´å·¥ä½œåˆ°åˆå¤œã€‚
# - å‘˜å·¥ 1 åœ¨å„ä¸ªæ—¶æ®µæ€»å…±å·¥ä½œäº† 20 å°æ—¶5åˆ†é’Ÿï¼Œä¸è¢«å¼€é™¤ã€‚
#å‘˜å·¥ 2:
# - å‚åŠ äº†ä¸€ä¸ªå·¥ä½œæ®µ:
#    - åœ¨ 2022-10-29, ä»–å·¥ä½œäº† 11 å°æ—¶ 59 åˆ†é’Ÿã€‚
# - å‘˜å·¥ 2 æ²¡æœ‰å·¥ä½œè¶³å¤Ÿçš„æ—¶é•¿ï¼Œå°†è¢«å¼€é™¤ã€‚
#å‘˜å·¥ 3:
# - æ²¡æœ‰ä»»ä½•å·¥ä½œæ®µã€‚
# - å‘˜å·¥ 3 æ²¡æœ‰å·¥ä½œè¶³å¤Ÿçš„æ—¶é•¿ï¼Œå°†è¢«å¼€é™¤ã€‚
# 
#
# Related Topics æ•°æ®åº“ ðŸ‘ 1 ðŸ‘Ž 0

public class EmployeesWithDeductions{
	public static void main(String[] args) {
		Solution solution = new EmployeesWithDeductions().new Solution();
		
	}
#leetcode submit region begin(Prohibit modification and deletion)
# Write your MySQL query statement below

select a.employee_id from Employees a left join
(select *,sum(ceil(TIMESTAMPDIFF(SECOND,in_time,out_time)/60))/60 diff from Logs group by employee_id) b on a.employee_id=b.employee_id
where a.needed_hours>ifnull(b.diff,0)

#leetcode submit region end(Prohibit modification and deletion)

}
